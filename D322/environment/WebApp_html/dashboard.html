<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      rel="shortcut icon"
      href="./assets/images/favicon.ico"
      type="image/x-icon"
    />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>GNR - Dashboards</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="Tables are the backbone of almost all web applications."
    />
    <meta name="msapplication-tap-highlight" content="no" />
    <!--
    =========================================================
    * ArchitectUI HTML Theme Dashboard - v1.0.0
    =========================================================
    * Product Page: https://dashboardpack.com
    * Copyright 2019 DashboardPack (https://dashboardpack.com)
    * Licensed under MIT (https://github.com/DashboardPack/architectui-html-theme-free/blob/master/LICENSE)
    =========================================================
    * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
    -->

    <link href="./main.css" rel="stylesheet" />
  </head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <body>
    <div
      class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header"
    >
      <div class="app-header header-shadow">
        <div class="app-header__logo">
          <div class="logo-src">
            <img src="./assets/images/logo.png" alt="" width="150px" />
          </div>
          <div class="header__pane ml-auto">
            <div>
              <button
                type="button"
                class="hamburger close-sidebar-btn hamburger--elastic"
                data-class="closed-sidebar"
              >
                <span class="hamburger-box">
                  <span class="hamburger-inner"></span>
                </span>
              </button>
            </div>
          </div>
        </div>
        <div class="app-header__mobile-menu">
          <div>
            <button
              type="button"
              class="hamburger hamburger--elastic mobile-toggle-nav"
            >
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
          </div>
        </div>
        <div class="app-header__menu">
          <span>
            <button
              type="button"
              class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav"
            >
              <span class="btn-icon-wrapper">
                <i class="fa fa-ellipsis-v fa-w-6"></i>
              </span>
            </button>
          </span>
        </div>
        <div class="app-header__content">
          <div class="app-header-left">
            <div class="search-wrapper">
              <div class="input-holder">
                <input
                  type="text"
                  class="search-input"
                  placeholder="Pesquise"
                />
                <button class="search-icon"><span></span></button>
              </div>
              <button class="close"></button>
            </div>
            <ul class="header-menu nav">
              <li class="btn-group nav-item">
                <a href="dashboard.html" class="nav-link">
                  <i class="nav-link-icon fa fa-edit"></i>
                  Dashboards
                </a>
              </li>
             
            </ul>
          </div>
          <div class="app-header-right">
            <div class="header-btn-lg pr-0">
              <div class="widget-content p-0">
                <div class="widget-content-wrapper">
                  <div class="widget-content-left">
                    <div class="btn-group">
                      <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="p-0 btn">
                        <img width="42" class="rounded-circle" src="assets/images/avatars/1.png" alt="" />
                        <i class="fa fa-angle-down ml-2 opacity-8"></i>
                      </a>
                      <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                        <a href="contaUtilizador.html"><button type="button" tabindex="0" class="dropdown-item" >Conta do
                          Utilizador</button></a>
                        
                        <div tabindex="-1" class="dropdown-divider"></div>
                        <button type="button" class="dropdown-item" data-toggle="modal" data-target=".bd-example-modal-sm" tabindex="0">Sair</button>
                      </div>
                    </div>
                  </div>
                  <div class="widget-content-left ml-3 header-user-info">
                    <div class="widget-heading">Gestor de Operações</div>
                    <div class="widget-subheading">Utilizador</div>
                  </div>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="app-main">
        <div class="app-sidebar sidebar-shadow">
          <div class="app-sidebar sidebar-shadow">
            <div class="app-header__logo">
              <div class="logo-src"></div>
              <div class="header__pane ml-auto">
                <div>
                  <button
                    type="button"
                    class="hamburger close-sidebar-btn hamburger--elastic"
                    data-class="closed-sidebar"
                  >
                    <span class="hamburger-box">
                      <span class="hamburger-inner"></span>
                    </span>
                  </button>
                </div>
              </div>
            </div>
            <div class="app-header__mobile-menu">
              <div>
                <button
                  type="button"
                  class="hamburger hamburger--elastic mobile-toggle-nav"
                >
                  <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                  </span>
                </button>
              </div>
            </div>
            <div class="app-header__menu">
              <span>
                <button
                  type="button"
                  class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav"
                >
                  <span class="btn-icon-wrapper">
                    <i class="fa fa-ellipsis-v fa-w-6"></i>
                  </span>
                </button>
              </span>
            </div>
            <div class="scrollbar-sidebar">
              <div class="app-sidebar__inner">
                <ul class="vertical-nav-menu">
                  <li class="app-sidebar__heading">Menu</li>

                  <li>
                    <a href="index.html" class="mm-active">
                      <i class="metismenu-icon pe-7s-home"></i>
                      Página Inicial
                    </a>
                  </li>

                  <li>
                    <a href="#">
                      <i class="metismenu-icon pe-7s-diamond"></i>
                      Materiais
                      <i
                        class="metismenu-state-icon pe-7s-angle-down caret-left"
                      ></i>
                    </a>
                    <ul>
                      <li>
                        <a href="materiais.html">
                          <i class="metismenu-icon"></i>
                          Lista de Materiais Disponíveis
                        </a>
                      </li>
                      <li>
                        <a href="reg-materiais.html">
                          <i class="metismenu-icon"></i>
                          Registo de Materiais
                        </a>
                      </li>
                      <li>
                        <a href="alocar-materiais.html">
                          <i class="metismenu-icon"> </i>Alocar Materiais
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="#">
                      <i class="metismenu-icon pe-7s-id"></i>
                      Operacionais
                      <i
                        class="metismenu-state-icon pe-7s-angle-down caret-left"
                      ></i>
                    </a>
                    <ul>
                      <li>
                        <a href="#">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Voluntários
                          <i
                            class="metismenu-state-icon pe-7s-angle-down caret-left"
                          ></i>
                        </a>
                        <ul>
                          <a href="voluntarios.html">
                            <i class="metismenu-icon pe-7s-display2"></i>
                            Lista de Voluntários
                          </a>
                          <a href="ped-voluntarios.html">
                            <i class="metismenu-icon pe-7s-display2"></i>
                            Pedidos de Voluntários
                          </a>
                        </ul>
                      </li>
                      <li>
                        <a href="#">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Profissionais
                          <i
                            class="metismenu-state-icon pe-7s-angle-down caret-left"
                          ></i>
                        </a>
                        <ul>
                          <a href="profissionais.html">
                            <i class="metismenu-icon pe-7s-display2"></i>
                            Lista de Profissionais
                          </a>
                        </ul>
                      </li>
                      <li>
                        <a href="prof-terrenos.html">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Profissionais no Terreno
                        </a>
                      </li>
                    </ul>
                  </li>

                  <li>
                    <a href="#">
                      <i class="metismenu-icon pe-7s-display2"></i>
                      Ocorrências
                      <i
                        class="metismenu-state-icon pe-7s-angle-down caret-left"
                      ></i>
                    </a>
                    <ul>
                      <li>
                        <a href="ocorrencias.html">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Ocorrências Pendentes
                        </a>
                      </li>
                      <li>
                        <a href="ped-ocorrencias.html">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Ocorrências Ativas
                        </a>
                      </li>
                      <li>
                        <a href="historico.html">
                          <i class="metismenu-icon pe-7s-display2"></i>
                          Histórico de Ocorrências
                        </a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="app-main__outer">
          <div class="app-main__inner">
            <div class="app-page-title">
              <div class="page-title-wrapper">
                <div class="page-title-heading">
                  <div>Dashboards</div>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="main-card mb-3 card">
                <div class="card-body">
                  <h5 class="card-title">Gráfico de Barras</h5>
                  <h5>Distribuição das Ocorrencias</h5>
                  <canvas id="myChart" style="width: 400px; height: 300px;"></canvas>               
              </div>
            </div>
            <div class="col-md-12">
              <div class="main-card mb-3 card">
                <div class="card-body">
                  <h5 class="card-title">Gráfico de Setores</h5>
                  <h5>Distribuição dos Operacionais</h5>
                  <div id="piechart" style="width: 900px; height: 500px;"></div>               
              </div>
            </div>
          <script>
                  window.onload = function () {
                    myChart();
                    pieChart();
                  }
                  
                  async function myChart(){
                    let reqs = [];

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/events`
                      );
                      const dados = await response.json();
                      const size = dados.length;
                      storeValues(size);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/events/estado/1`
                      );
                      const dados1 = await response.json();
                      const size1 = dados1.length;
                      storeValues(size1);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/events/estado/2`
                      );
                      const dados2 = await response.json();
                      const size2 = dados2.length;
                      storeValues(size2);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/events/estado/3`
                      );
                      const dados3 = await response.json();
                      const size3 = dados3.length;
                      storeValues(size3);
                    })();

                    function storeValues(req) {
                      reqs.push(req);
                      renderStuff(reqs);
                    }

                    function renderStuff(reqs) {
                      const ctx = document
                        .getElementById("myChart")
                        .getContext("2d");
                      const myChart = new Chart(ctx, {
                        type: "bar",
                        data: {
                          labels: ["A Decorrer", "Pendentes", "Concluidas"],
                          datasets: [
                            {
                              label: "Distribuição das Ocorrencias",
                              data: [reqs[1], reqs[2], reqs[3]],
                              backgroundColor: [
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                              ],
                              borderColor: [
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                                "rgba(0,255,127, 1)",
                              ],
                              borderWidth: 1,
                            },
                          ],
                        },
                        options: {
                          scales: {
                            yAxes: [
                              {
                                ticks: {
                                  beginAtZero: true,
                                },
                              },
                            ],
                          },
                        },
                      });
                    }

                    getData();

                    async function getData() {
                      const response = await fetch(
                        `http://127.0.0.1:8080/events/api/estados`
                      );
                      const data = await response.text();

                      const table = data.split("\n").slice(1);
                    }
                  }

                  async function pieChart(){
                    let reqs = [];

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/operationals`
                      );
                      const dados = await response.json();
                      const size = dados.length;
                      storeValues(size);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/operationals/api/profissionais`
                      );
                      const dados1 = await response.json();
                      const size1 = dados1.length;
                      storeValues(size1);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/operationals/posto/101`
                      );
                      const dados2 = await response.json();
                      const size2 = dados2.length;
                      storeValues(size2);
                    })();

                    (async () => {
                      const response = await fetch(
                        `http://127.0.0.1:8080/operationals/posto/102`
                      );
                      const dados3 = await response.json();
                      const size3 = dados3.length;
                      storeValues(size3);
                    })();

                    function storeValues(req) {
                      reqs.push(req);
                      renderStuff(reqs);
                    }

                    function renderStuff(reqs){
            // Load google charts
            google.charts.load('current', { 'packages': ['corechart'] });
            google.charts.setOnLoadCallback(drawChart);
            
            // Draw the chart and set the chart values
            function drawChart() {
                var data = google.visualization.arrayToDataTable([
                    ['Operacionais', 'Número de Operacionais'],
                    ['Profissionais', reqs[1]],
                    ['Voluntários', reqs[2]],
                    ['Candidatos', reqs[3]]
                ]);

                // Optional; add a title and set the width and height of the chart
                var options = { 'title': 'Número de Operacionais', 'width': 1050, 'height': 500 };

                // Display the chart inside the <div> element with id="piechart"
                var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                chart.draw(data, options);
            }
          }

                    getData();

                    async function getData() {
                      const response = await fetch(
                        `http://127.0.0.1:8080/operationals`
                      );
                      const data = await response.text();

                      const table = data.split("\n").slice(1);
                    }
                  }

                </script>

          
        </div>
      </div>
    </div>
    <script type="text/javascript" src="./assets/scripts/main.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  </body>
</html>

<div class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Sair?</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body">
              <p>Tem a certeza que quer sair?</p>
          </div>
          <div class="modal-footer">
            <a href="login.html"><button type="button" class="btn btn-secondary" >Sim</button></a>
              <a href="index.html"><button type="button" class="btn btn-primary">Não</button></a>
              
          </div>
      </div>
  </div>
</div>
